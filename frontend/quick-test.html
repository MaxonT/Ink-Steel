<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>å¿«é€Ÿæµ‹è¯•</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #f5f5f5; }
        .container { background: white; padding: 20px; border-radius: 8px; max-width: 800px; }
        h2 { color: #333; border-bottom: 2px solid #007bff; padding-bottom: 10px; }
        button { background: #007bff; color: white; border: none; padding: 10px 20px; margin: 5px; cursor: pointer; border-radius: 4px; }
        button:hover { background: #0056b3; }
        .result { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 4px; border-left: 4px solid #007bff; }
        .success { border-left-color: #4caf50; }
        .error { border-left-color: #f44336; }
        pre { background: #f9f9f9; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª Ink & Steel å¿«é€Ÿè¯Šæ–­</h1>
        
        <h2>1. æµ‹è¯• JSON åŠ è½½</h2>
        <button onclick="testJSON()">æµ‹è¯• JSON</button>
        <div id="json-result"></div>

        <h2>2. æµ‹è¯•ç¬”è¯¦æƒ…é¡µ</h2>
        <button onclick="goToPenDetail()">æ‰“å¼€ç¬”è¯¦æƒ…é¡µ</button>
        <button onclick="testDirectRender()">æµ‹è¯•ç›´æ¥æ¸²æŸ“</button>
        <div id="render-result"></div>

        <h2>3. å¿«é€Ÿé“¾æ¥</h2>
        <a href="pen-detail.html?id=pelikan-m800-black" target="_blank"><button>Pelikan M800</button></a>
        <a href="pen-detail.html?id=pilot-custom-74" target="_blank"><button>Pilot Custom 74</button></a>
        <a href="pen-detail.html?id=montblanc-149" target="_blank"><button>Montblanc 149</button></a>
    </div>

    <script>
        async function testJSON() {
            const resultDiv = document.getElementById('json-result');
            resultDiv.innerHTML = '<div class="result">åŠ è½½ä¸­...</div>';
            
            try {
                const response = await fetch('data/pens.json');
                const data = await response.json();
                
                if (data.pens && data.pens.length > 0) {
                    const firstPen = data.pens[0];
                    resultDiv.innerHTML = `
                        <div class="result success">
                            <strong>âœ… JSON åŠ è½½æˆåŠŸ!</strong><br>
                            æ€»ç¬”æ•°: ${data.pens.length}<br>
                            ç¬¬ä¸€ä¸ªç¬”: ${firstPen.name} (ID: ${firstPen.id})<br>
                            <pre>${JSON.stringify(firstPen, null, 2).substring(0, 500)}...</pre>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = '<div class="result error">âŒ JSON ç»“æ„é”™è¯¯</div>';
                }
            } catch (e) {
                resultDiv.innerHTML = `<div class="result error">âŒ é”™è¯¯: ${e.message}</div>`;
            }
        }

        function goToPenDetail() {
            window.location.href = 'pen-detail.html?id=pelikan-m800-black';
        }

        async function testDirectRender() {
            const resultDiv = document.getElementById('render-result');
            resultDiv.innerHTML = '<div class="result">æµ‹è¯•ä¸­...</div>';
            
            try {
                // åŠ è½½ç»„ä»¶è„šæœ¬
                if (!customElements.get('pen-detail')) {
                    const script = document.createElement('script');
                    script.src = 'assets/scripts/components/pen-detail.js';
                    document.head.appendChild(script);
                    
                    await new Promise(resolve => setTimeout(resolve, 500));
                }
                
                // åŠ è½½æ•°æ®
                const response = await fetch('data/pens.json');
                const data = await response.json();
                const testPen = data.pens[0];
                
                // åˆ›å»ºå…ƒç´ å¹¶æ¸²æŸ“
                const container = document.createElement('div');
                const penDetail = document.createElement('pen-detail');
                
                penDetail.setAttribute('pen-data', JSON.stringify(testPen));
                if (typeof penDetail.render === 'function') {
                    penDetail.render();
                }
                
                container.appendChild(penDetail);
                resultDiv.innerHTML = '';
                resultDiv.appendChild(container);
                
                resultDiv.innerHTML = `<div class="result success">âœ… æ¸²æŸ“æµ‹è¯•å®Œæˆ (${testPen.name})</div>` + resultDiv.innerHTML;
                
            } catch (e) {
                resultDiv.innerHTML = `<div class="result error">âŒ é”™è¯¯: ${e.message}</div>`;
            }
        }
    </script>
</body>
</html>
